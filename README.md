## Backup Media Syncer
### About
This was created to solve a need in my personal media setup.  I'll probably only update it if my needs change.

The program works in two phases which correspond to the two files.  (`_media_merge.py`) Identify discrepancies between the original directory and the backup directory and log those discrepancies.  (`_sync.py`) Rectify the changes outlined in the diff file created by the previous phase.

Because of the structure of the program, any necessary changes identified by `_media_merge.py` aren't made until you are able to review the file.  Any changes you don't approve of can simply be removed from the diff file before running `_sync.py`.

### Requirements
This program has only been tested with python 3.x.  It'll probably work with python 2.x with minior modifications.

### How-to
* First, rename `_media_merge.py` to either `_movie_merge.py` or `_show_merge.py`.  
* Place the file you just renamed into the backup directory.
* Then, set the root origin directory for your movies and tv shows by editing lines 7 and 8 of the file you just renamed.  Run the file.
* It'll create three files on your desktop (you can change this destination by editing line 6).  
 * The first two files just list the contnets of your origin and backup directories (you can use a diff comparison to see what the differances are, if you'd like). 
 * The third file is a custom diff file which the program generated that notes the origin directory, the backup directory, and all the files that are new in the origin dir and need to be deleted from the backup dir.
* Look over all the proposed changes in the diff file.  If there are any changes that you don't want made, simply delete that line.
* When you are satisfied with the proposed changes, run the `_sync.py` file.

### Notes

* This program assumes that if the filenames is the same, then so are the file (I may add hashing or modified date comparison in the future).
* `_media_merge.py`
 * Line 6 controls the log directory.
 * Line 7 controls the origin root directory.
 * Line 8 controls the backup directory.
 * Line 21 controls the extension blacklist that won't be synced.
 * Lines 68 through 77 are what force `_media_merge.py` to be in the backup directory.  Modifying that will change the behavior.
* `_sync.py`
 * Assumes that the the log files were saved to the user's desktop.
 * Relies on the diff file generated by the renamed `_media_merge.py`.
 * Creates a log file on the desktop that outlines the changes madee.
 
 ### Mechanics
 
* `_media_merge.py` - Compares the backup and original directory (does not modify contents of either).
 * The steps to accomplish the part are 
 1. Determine if this is working with the TV shows directory or the Movies directory (lines 70-77).
 2. Create a list of all interesting files in the original directory and in the backup directory (a file is considered interesting if it doesn't match the extension blacklist on line 21).
 2. Save the file list from both directories as text files (with the root directory stripped off).
 3. Look for entries that are present in the original directory but not in the backup directory.  Those need to be added to the backup directory.
 4. Look for entries that present in the backup directory but not in the original directory.  Those need to be removed from the backup directory.
 5. Save the results from 3 and 4 to a plaintext file. 
 * Steps 1 and 2 are handled by the `indexfiles(rootdir, outputfilepath)` function.
 * Steps 3, 4, and 5 are handled by the `compbackup(origionallog, backuplog, rotdirs, outdir)` function.
    
 
 
* `_sync.py` - Rectifies differences between the backup and original directory (only modifies contents of the backup directory).
 * The steps to accomplish the part are 
1. Determine the original directory from the line in the diff file that starts with `[ORG_DIR]**`.
2. Determine the backup directory from the line in the diff file that starts with `[BAK_DIR]**`.
3. Look for lines that start with `[ADD]**`.
  1. Check if the subdirectory the file will be added to exists
  2. If not, create it
  3. Copy the file listed on the given line from the original directory to the backup directory
4. Look for lines that start with `[DEL]**`.
  1. Try to delete the referenced file from the backup directory.
5. Log any added or removed files to a logfile.
 * Steps 1 and 2 are handled by lines 13-37.
 * Step 3 is handled by lines 44-58.
 * Step 4 is handled by lines 60-74.
 * Step 5 is handled at the same time as steps 3 and 4.